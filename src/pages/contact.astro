---
import Layout from '../layouts/Layout.astro';
---

<Layout title="VetPulse | Request Market Intelligence">
  <div class="bg-gray-50 pt-32 pb-16 px-4">
    <div class="max-w-3xl mx-auto">
      <!-- Eyebrow LEFT-ALIGNED -->
      <p class="text-[#0eb4b3] text-sm font-mono font-bold tracking-[0.15em] uppercase mb-6 flex items-center hero-eyebrow">
        <span class="w-2 h-2 bg-[#0eb4b3] inline-block mr-2"></span>
        COMMISSION A BRIEFING
      </p>
      
      <!-- Heading and description CENTERED -->
      <div class="text-center mb-6 hero-content">
        <h1 class="text-3xl font-bold text-[#0b1430] mb-2">
          Request Market Intelligence
        </h1>
        
        <p class="text-gray-600">
          We accept new research mandates on a rolling basis. Projects start at $10k.
        </p>
      </div>
      
      <!-- Form container with border -->
      <div class="bg-white rounded-lg border border-gray-200 shadow-sm p-8 md:p-12 form-container">
        <form id="contactForm" class="space-y-6">
          <div>
            <label for="name" class="block text-sm font-medium text-gray-700 mb-2">
              Name *
            </label>
            <input
              type="text"
              id="name"
              name="name"
              required
              minlength="2"
              class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent"
            />
            <span class="error-message text-red-500 text-sm hidden">Please enter your name</span>
          </div>

          <div>
            <label for="email" class="block text-sm font-medium text-gray-700 mb-2">
              Email *
            </label>
            <input
              type="email"
              id="email"
              name="email"
              required
              class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent"
            />
            <span class="error-message text-red-500 text-sm hidden">Please enter a valid email</span>
          </div>

          <div>
            <label for="company" class="block text-sm font-medium text-gray-700 mb-2">
              Company
            </label>
            <input
              type="text"
              id="company"
              name="company"
              class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent"
            />
          </div>

          <div>
            <label for="message" class="block text-sm font-medium text-gray-700 mb-2">
              Research Request *
            </label>
            <textarea
              id="message"
              name="message"
              required
              minlength="10"
              rows="5"
              class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent"
            ></textarea>
            <span class="error-message text-red-500 text-sm hidden">Please describe your research needs</span>
          </div>

          <button
            type="submit"
            id="submitBtn"
            class="w-full bg-[#0eb4b3] text-white font-semibold py-3 px-6 rounded-lg hover:bg-[#0d9b9a] transition-colors disabled:opacity-50 disabled:cursor-not-allowed"
          >
            Submit Request
          </button>
        </form>

        <div id="successMessage" class="hidden mt-4 p-4 bg-green-50 text-green-700 rounded-lg">
          Thank you! Your request has been received (STUB).
        </div>

        <p class="text-gray-600 text-sm mt-6 text-center">
          Or contact us directly: <a href="mailto:contact@vetpulse.com" class="text-[#0eb4b3] hover:underline">contact@vetpulse.com</a>
        </p>
      </div>
    </div>
  </div>
</Layout>

<style>
  html {
    scroll-behavior: smooth;
  }
  
  /* Hero eyebrow animation */
  .hero-eyebrow {
    opacity: 0;
    animation: fadeInUp 0.8s ease-out forwards;
  }
  
  /* Hero content animation */
  .hero-content {
    opacity: 0;
    animation: fadeInUp 0.8s ease-out 0.2s forwards;
  }
  
  /* Form container animation */
  .form-container {
    opacity: 0;
    animation: fadeInUp 0.8s ease-out 0.4s forwards;
  }
  
  /* Scroll-triggered fade-in for other sections */
  .fade-in-section {
    opacity: 0;
    transform: translateY(30px);
    transition: opacity 0.8s ease-out, transform 0.8s ease-out;
  }
  
  .fade-in-section.is-visible {
    opacity: 1;
    transform: translateY(0);
  }
  
  @keyframes fadeInUp {
    from {
      opacity: 0;
      transform: translateY(30px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
</style>

<script>
  const form = document.getElementById('contactForm') as HTMLFormElement;
  const submitBtn = document.getElementById('submitBtn') as HTMLButtonElement;
  const successMessage = document.getElementById('successMessage');

  form.addEventListener('submit', async (e) => {
    e.preventDefault();
    
    // Get form data
    const formData = new FormData(form);
    const data = Object.fromEntries(formData);
    
    // Stub: Console log instead of actual submission
    console.log('Form submitted:', data);
    
    // Disable button during "submission"
    submitBtn.disabled = true;
    submitBtn.textContent = 'Submitting...';
    
    // Mock API delay
    setTimeout(() => {
      // Show success message
      successMessage?.classList.remove('hidden');
      form.classList.add('hidden');
      
      // Reset after 3 seconds (optional for testing)
      setTimeout(() => {
        form.reset();
        form.classList.remove('hidden');
        successMessage?.classList.add('hidden');
        submitBtn.disabled = false;
        submitBtn.textContent = 'Submit Request';
      }, 3000);
    }, 1000);
  });

  // Client-side validation
  const inputs = form.querySelectorAll('input[required], textarea[required]');
  inputs.forEach(input => {
    input.addEventListener('blur', (e) => {
      const target = e.target as HTMLInputElement;
      const errorMsg = target.nextElementSibling as HTMLElement;
      
      if (!target.checkValidity()) {
        target.classList.add('border-red-500');
        errorMsg?.classList.remove('hidden');
      } else {
        target.classList.remove('border-red-500');
        errorMsg?.classList.add('hidden');
      }
    });
  });

  // Intersection Observer for scroll-triggered animations
  document.addEventListener('DOMContentLoaded', () => {
    const observerOptions = {
      threshold: 0.1,
      rootMargin: '0px 0px -100px 0px'
    };

    const observer = new IntersectionObserver((entries) => {
      entries.forEach((entry) => {
        if (entry.isIntersecting) {
          entry.target.classList.add('is-visible');
        }
      });
    }, observerOptions);

    // Observe all fade-in sections
    const fadeInSections = document.querySelectorAll('.fade-in-section');
    fadeInSections.forEach((section) => {
      observer.observe(section);
    });
  });
</script>
